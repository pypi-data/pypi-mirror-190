import{aY as b,d as k,V as D,al as N,aZ as V,c as u,a0 as x,e as a,a as F,w as d,g as I,a2 as O,a3 as T,a_ as B,o as J,b as i,a$ as P,b0 as U,b1 as M,b2 as Z,v as y}from"./index-1ad4f081-98325998.js";import{u as $}from"./usePageTitle-b23eb992.js";import"./index-eb9d0889.js";import{r as f}from"./routes-7f16c85e.js";import"./meta-26546594.js";class j extends b{parse(t){return JSON.parse(decodeURIComponent(t??""))}format(t){return encodeURIComponent(JSON.stringify(t))}}const z=k({__name:"FlowRunCreate",setup(w){const t=D(),s=N("deploymentId"),n=T(),p=V("parameters",j,{}),_=u(()=>!e.value||!p.value?{}:B.map("SchemaValuesResponse",{schema:e.value.parameterOpenApiSchema,values:p.value},"SchemaValues")),h=x(t.deployments.getDeployment,[s]),e=u(()=>h.response),R=async r=>{var l,o;try{const m=await t.deployments.createDeploymentFlowRun(s.value,r),c=((o=(l=r.state)==null?void 0:l.stateDetails)==null?void 0:o.scheduledTime)??void 0,g=!c,S=M(Z,{flowRun:m,flowRunRoute:f.flowRun,router:n,immediate:g,startTime:c});y(S,"success"),n.push(f.deployment(s.value))}catch(m){y("Something went wrong trying to create a flow run","error"),console.error(m)}},v=()=>{n.back()},C=u(()=>e.value?`Create Flow Run for Deployment: ${e.value.name}`:"Create Flow Run for Deployment");return $(C),(r,l)=>{const o=O("p-layout-default");return a(e)?(J(),F(o,{key:0},{header:d(()=>[i(a(P),{deployment:a(e)},null,8,["deployment"])]),default:d(()=>[i(a(U),{deployment:a(e),parameters:a(_),onSubmit:R,onCancel:v},null,8,["deployment","parameters"])]),_:1})):I("",!0)}}});export{z as default};
