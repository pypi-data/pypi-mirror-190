(this.webpackJsonppytest_commander=this.webpackJsonppytest_commander||[]).push([[0],{142:function(e,n,t){"use strict";t.r(n);var s=t(2),c=t.n(s),a=t(73),i=t.n(a),o=t(79),l=t(74),r=t(42),d=t(75),h=t(27),u=t(43),j=t(47),b=t(76),g=t.n(b),v=t(77),f=t.n(v),O=t(0);var p=function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{children:" HiL Self-Diagnostic Tool "}),Object(O.jsxs)("h6",{children:["  ",Object(O.jsx)("small",{children:"\xa9 "})," Pass Testing Solutions GmbH "]})]})},x=t(21),m=t(4),T=t(3),E="#F3F3F3",L="#D0D0D0",R="25em",y=t(44),k=t.n(y),w=t(143),D=t(144),I=t(10),B=t(11),N=function(e){return k.a.isEmpty(e.childBranches)&&k.a.isEmpty(e.childLeaves)?Object(O.jsx)("div",{className:Object(T.b)(H.navColumn)}):Object(O.jsx)("div",{className:Object(T.b)(H.navColumn),children:Object(O.jsx)(w.a,{children:Object(O.jsx)(C,{childBranches:e.childBranches,childLeaves:e.childLeaves,selection:e.selection,selectedLeafID:e.selectedLeafID,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle})})})},C=function(e){var n=Object.keys(e.childBranches).map((function(e){return{shortID:e,branch:!0}})).concat(Object.keys(e.childLeaves).map((function(e){return{shortID:e,branch:!1}}))).sort((function(e,n){return e.shortID.localeCompare(n.shortID)}));return Object(O.jsx)(O.Fragment,{children:n.map((function(n){if(n.branch){var t=e.childBranches[n.shortID];return Object(O.jsx)(P,{node:t,selection:e.selection,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle})}var s=e.childLeaves[n.shortID];return Object(O.jsx)(_,{node:s,selectedLeafID:e.selectedLeafID,handleTestRun:e.handleTestRun})}))})},P=function(e){var n="/"+e.selection.concat([e.node.short_id]).map(encodeURIComponent).join("/");return Object(O.jsxs)(D.a,{className:Object(T.b)(U(e.node.status),H.navEntryCommon),children:[Object(O.jsx)("span",{className:Object(T.b)(H.navLabel),children:Object(O.jsx)(x.b,{to:n,children:e.node.short_id})}),Object(O.jsx)(S,{node:e.node,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle})]},e.node.short_id)},S=function(e){return"inactive"===e.node.environment_state?Object(O.jsx)(z,{nodeid:e.node.nodeid,status:e.node.status,handleTestRun:e.handleTestRun}):Object(O.jsxs)("span",{className:Object(T.b)(H.buttonsContainer,H.navEntryCommon),children:[Object(O.jsx)(F,{envStatus:e.node.environment_state,handleEnvToggle:e.handleEnvToggle,nodeid:e.node.nodeid}),Object(O.jsx)(z,{nodeid:e.node.nodeid,status:e.node.status,handleTestRun:e.handleTestRun})]})},_=function(e){var n=e.node.short_id,t=n===e.selectedLeafID?n:Object(O.jsx)(x.b,{to:"?selectedLeaf=".concat(encodeURIComponent(n)),children:n});return Object(O.jsxs)(D.a,{className:Object(T.b)(U(e.node.status),H.navEntryCommon),children:[Object(O.jsx)("span",{className:Object(T.b)(H.navLabel),children:t}),Object(O.jsx)(z,{nodeid:e.node.nodeid,status:e.node.status,handleTestRun:e.handleTestRun})]},n)},z=function(e){return"running"===e.status?Object(O.jsx)(I.a,{icon:B.d,className:Object(T.b)(H.inactiveButton),size:"lg",spin:!0}):Object(O.jsx)(I.a,{icon:B.c,onClick:function(n){n.stopPropagation(),e.handleTestRun(e.nodeid)},className:Object(T.b)(H.runButton),size:"lg"})},F=function(e){switch(e.envStatus){case"stopped":return Object(O.jsx)(I.a,{icon:B.f,className:Object(T.b)(H.runButton),onClick:function(n){n.stopPropagation(),e.handleEnvToggle(e.nodeid,!0)},size:"lg"});case"started":return Object(O.jsx)(I.a,{icon:B.g,className:Object(T.b)(H.runButton),onClick:function(n){n.stopPropagation(),e.handleEnvToggle(e.nodeid,!1)},size:"lg"});case"stopping":return Object(O.jsx)(I.a,{icon:B.g,className:Object(T.b)(H.inactiveButton),size:"lg"});default:throw new Error("unexpected environment status "+e.envStatus)}},U=function(e){switch(e){case"passed":return H.navEntryPassed;case"failed":return H.navEntryFailed;default:return H.navEntryDefault}},H=T.a.create({buttonsContainer:{width:"3em"},navColumn:{height:"100%",width:R,position:"fixed","z-index":1,top:0,left:0,"overflow-x":"hidden",padding:"1px",background:E},navLabel:{"text-overflow":"ellipsis","white-space":"nowrap",fontSize:"small","max-width":"80%"},runButton:{cursor:"pointer",color:"black","padding-left":"3px","padding-right":"3px",transition:"color 0.3s ease-out 0s",":hover":{color:E}},inactiveButton:{color:E,"padding-left":"3px","padding-right":"3px"},navEntryPassed:{background:"#c0ffbf"},navEntryFailed:{background:"#ff7a7a"},navEntryDefault:{background:L},navEntryCommon:{display:"flex","justify-content":"space-between","align-items":"center"}}),M=t(145),A=t(146),J=function(e){return e.selectedLeaf?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{children:[Object(O.jsx)("span",{className:Object(T.b)(K.title),children:e.selectedLeaf.nodeid}),Object(O.jsx)("span",{className:Object(T.b)(K.statusIcon),children:$(e.selectedLeaf.status)})]}),Object(O.jsx)("pre",{className:Object(T.b)(K.longrepr),children:e.selectedLeaf.longrepr})]}):Object(O.jsx)(G,{message:"Please select a test."})},G=function(e){return Object(O.jsx)("h1",{className:Object(T.b)(K.message),children:e.message})},$=function(e){switch(e){case"passed":return Object(O.jsx)(I.a,{icon:B.a,color:"green",size:"4x"});case"failed":return Object(O.jsx)(I.a,{icon:B.e,color:"red",size:"4x"});default:return null}},q=function(e){var n=e.selection.length;if(!n)return Object(O.jsx)(M.a,{children:Object(O.jsx)(A.a,{children:Object(O.jsx)(I.a,{icon:B.b})},"home")});var t=e.selection[n-1],s=e.selection.slice(0,n-1);return Object(O.jsxs)(M.a,{children:[Object(O.jsx)(A.a,{children:Object(O.jsx)(x.b,{to:"/",children:Object(O.jsx)(I.a,{icon:B.b})})},"home"),s.map((function(n,t){return Object(O.jsx)(A.a,{children:Object(O.jsx)(x.b,{to:"/"+e.selection.slice(0,t+1).map(encodeURIComponent).join("/"),children:n})},n)})),Object(O.jsx)(A.a,{children:t})]})},K=T.a.create({title:{fontSize:"large","font-weight":"bold","text-overflow":"ellipsis","white-space":"nowrap",padding:"10px"},statusIcon:{float:"right"},longrepr:{padding:"10px"},message:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",minHeight:"80vh",color:L}}),Q=function(e){Object(u.a)(t,e);var n=Object(j.a)(t);function t(e){var s;return Object(r.a)(this,t),(s=n.call(this,e)).state={resultTree:null,loading:!1,socket:null,errorMessage:null},s.handleUpdate=s.handleUpdate.bind(Object(h.a)(s)),s.handleTestRun=s.handleTestRun.bind(Object(h.a)(s)),s.handleEnvToggle=s.handleEnvToggle.bind(Object(h.a)(s)),s}return Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,n=f()();this.setState({loading:!0,socket:n},(function(){n.on("update",e.handleUpdate),e.getResultTree(100)}))}},{key:"getResultTree",value:function(e){var n=this;g.a.get("/api/v1/result-tree").then((function(e){n.setState({resultTree:e.data,loading:!1})})).catch((function(t){console.log("API error: "+t),setTimeout((function(){return n.getResultTree(2*e)}),e)}))}},{key:"handleUpdate",value:function(e){console.log("Handling websocket update"),this.setState({resultTree:e})}},{key:"handleTestRun",value:function(e){this.state.socket?this.state.socket.emit("run test",e):console.log("Socket connection not yet established")}},{key:"handleEnvToggle",value:function(e,n){this.state.socket?n?this.state.socket.emit("start env",e):this.state.socket.emit("stop env",e):console.log("Socket connection not yet established")}},{key:"render",value:function(){var e=V(this.props.url);if(this.state.errorMessage)return Object(O.jsx)(X,{message:this.state.errorMessage,selection:e});try{var n=Z(e,this.state.resultTree),t=n.childBranches,s=n.childLeaves;return Object(O.jsx)("div",{children:Object(O.jsx)(W,{childBranches:t,childLeaves:s,selection:e,handleTestRun:this.handleTestRun,handleEnvToggle:this.handleEnvToggle})})}catch(c){if(c instanceof te)return Object(O.jsx)(X,{message:"404 Page Not Found",selection:e});throw c}}}]),t}(c.a.Component),V=function(e){if(!e)return[];var n=e.replace(/^\/+|\/+$/g,"");return 0===n.length?[]:n.split("/").map(decodeURIComponent)},W=function(e){var n=Y().get("selectedLeaf"),t=n?e.childLeaves[n]:null;return Object(O.jsxs)("div",{children:[Object(O.jsx)(N,{childBranches:e.childBranches,childLeaves:e.childLeaves,selectedLeafID:n,selection:e.selection,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle}),Object(O.jsxs)("div",{className:Object(T.b)(ee.centrePane),children:[Object(O.jsxs)("div",{className:Object(T.b)(ne.heading),children:[" ",Object(O.jsx)(p,{})," "]}),Object(O.jsx)(q,{selection:e.selection}),Object(O.jsx)(J,{selectedLeaf:t})]})]})},X=function(e){return Object(O.jsxs)("div",{children:[Object(O.jsx)(N,{childBranches:{},childLeaves:{},selectedLeafID:null,selection:[],handleTestRun:function(e){},handleEnvToggle:function(e,n){}}),Object(O.jsxs)("div",{className:Object(T.b)(ee.centrePane),children:[Object(O.jsx)(q,{selection:e.selection}),Object(O.jsx)(G,{message:e.message})]})]})},Y=function(){return new URLSearchParams(Object(m.e)().search)},Z=function(e,n){if(!n)return{childBranches:{},childLeaves:{}};if(0===e.length)return{childBranches:Object(l.a)({},n.short_id,n),childLeaves:{}};var t=e.slice(1).reduce((function(e,n){return null===e||void 0===e?void 0:e.child_branches[n]}),n);if(t)return{childBranches:t.child_branches,childLeaves:t.child_leaves};throw new te("Not found",e)},ee=T.a.create({centrePane:{"margin-left":R,padding:"10px 10px"}}),ne=T.a.create({heading:{"margin-left":"8em","margin-right":"8em",alignItems:"center",textAlign:"center",padding:"10px 10px",color:"#60DEFD",background:E}}),te=function(e){Object(u.a)(t,e);var n=Object(j.a)(t);function t(e,s){var c;return Object(r.a)(this,t),(c=n.call(this,e)).selection=void 0,c.selection=s,c}return t}(Object(o.a)(Error)),se=function(){return Object(O.jsx)(x.a,{children:Object(O.jsx)(m.a,{path:"/",render:function(e){var n=e.location;return Object(O.jsx)(Q,{url:n.pathname})}})})};t(141);i.a.render(Object(O.jsx)(se,{}),document.getElementById("root"))}},[[142,1,2]]]);
//# sourceMappingURL=main.f0984714.chunk.js.map