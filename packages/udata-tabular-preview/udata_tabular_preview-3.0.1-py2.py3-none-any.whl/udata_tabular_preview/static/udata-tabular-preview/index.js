import{defineComponent as T,computed as U,openBlock as u,createElementBlock as d,createElementVNode as a,withModifiers as _,toDisplayString as g,normalizeClass as B,Fragment as m,renderList as w,resolveComponent as N,createBlock as D,withCtx as K,ref as h,createTextVNode as Y,createCommentVNode as k}from"vue";import{ContentLoader as H}from"vue-content-loader";function nn(){import("data:text/javascript,")}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();const S=3;function O(e,n=1){return[...Array(e).keys()].map(t=>t+n)}function J(e){return O(e)}function Q(e,n){return Math.min(S*2+1,e.length-2,S+n-1,S+e.length-n)}function W(e){return Math.max(e-S,2)}function X(e,n){const t=J(n),r=W(e);if(n<=2)return[];let o=O(Q(t,e),r);return o.includes(2)||o.unshift(null),o.includes(n-1)||o.push(null),o}const R=(e,n)=>{const t=e.__vccOpts||e;for(const[r,o]of n)t[r]=o;return t},Z=T({props:{page:{type:Number,default:1},changePage:{type:Function,required:!0},pageSize:{type:Number,default:20},totalResults:{type:Number,required:!0}},setup(e){const n=U(()=>Math.ceil(e.totalResults/e.pageSize)),t=U(()=>X(e.page,n.value));return{pageCount:n,visiblePages:t,onClick:i=>{if(i!==e.page)return e.changePage(i)},nextPage:()=>{const i=e.page+1;if(i<=n.value)return e.changePage(i)},previousPage:()=>{const i=e.page-1;if(i>0)return e.changePage(i)}}}}),x={role:"navigation",class:"fr-pagination fr-pagination--centered","aria-label":"Pagination"},ee={class:"fr-pagination__list"},ne=["href"],te=["href"],re=["aria-current","href","title"],oe=["aria-current","href","title","onClick","data-page"],ae={key:1,class:"fr-pagination__link fr-hidden fr-unhidden-lg"},ie=["aria-current","href","title","data-page"],le=["href"],se=["href"];function ue(e,n,t,r,o,l){return u(),d("nav",x,[a("ul",ee,[a("li",null,[a("a",{href:e.page===1?void 0:"#",class:"fr-pagination__link fr-pagination__link--first",onClick:n[0]||(n[0]=_(i=>e.onClick(1),["prevent"]))},g(e.$t("First page")),9,ne)]),a("li",null,[a("a",{href:e.page===1?void 0:"#",class:"fr-pagination__link fr-pagination__link--prev fr-pagination__link--lg-label",onClick:n[1]||(n[1]=_((...i)=>e.previousPage&&e.previousPage(...i),["prevent"]))},g(e.$t("Previous page")),9,te)]),a("li",null,[a("a",{"aria-current":e.page===1?"page":void 0,href:e.page===1?void 0:"#",class:B(["fr-pagination__link",{"fr-hidden fr-unhidden-sm":e.page>1}]),title:e.$t("Page",{nb:1}),onClick:n[2]||(n[2]=_(i=>e.onClick(1),["prevent"])),"data-page":1}," 1 ",10,re)]),(u(!0),d(m,null,w(e.visiblePages,i=>(u(),d("li",null,[i?(u(),d("a",{key:0,class:B(["fr-pagination__link",{"fr-hidden fr-unhidden-lg":i<e.page-1||i>e.page+1}]),"aria-current":e.page===i?"page":void 0,href:e.page===i?void 0:"#",title:e.$t("Page",{nb:i}),onClick:_(f=>e.onClick(i),["prevent"]),"data-page":i},g(i),11,oe)):(u(),d("a",ae," \u2026 "))]))),256)),a("li",null,[a("a",{class:"fr-pagination__link","aria-current":e.page===e.pageCount?"page":void 0,href:e.page===e.pageCount?void 0:"#",title:e.$t("Page",{nb:e.pageCount}),onClick:n[3]||(n[3]=_(i=>e.onClick(e.pageCount),["prevent"])),"data-page":e.pageCount},g(e.pageCount),9,ie)]),a("li",null,[a("a",{class:"fr-pagination__link fr-pagination__link--next fr-pagination__link--lg-label",href:e.page===e.pageCount?void 0:"#",onClick:n[4]||(n[4]=_((...i)=>e.nextPage&&e.nextPage(...i),["prevent"]))},g(e.$t("Next page")),9,le)]),a("li",null,[a("a",{class:"fr-pagination__link fr-pagination__link--last",href:e.page===e.pageCount?void 0:"#",onClick:n[5]||(n[5]=_(i=>e.onClick(e.pageCount),["prevent"]))},g(e.$t("Last page")),9,se)])])])}const ce=R(Z,[["render",ue]]);var q;const $=(q=globalThis.udata_front)!=null?q:{components:{},translations:[]};function de(e,n,t,r){$.components[e]||($.components[e]=[]);const o={component:n,hook:e,module:t,name:r};return $.components[e].push(o),o}function fe(e,n){const t={messages:e,module:n};return $.translations.push(t),t}globalThis.udata_front=$;let s={csvapiUrl:null,dataEndpoint:null,filters:[],page:1,pageSize:10,sortBy:null,sortDesc:!1,totalRows:0};function C(e){s={...s,...e}}function ge(e){if(s.page=e,s.page-1<=s.totalRows/s.pageSize)return j("page")}function pe(e,n=!1){return s.sortBy=e,s.sortDesc=n,j("sort")}function he(e){let n=0;if(e&&e==="page"?n=s.pageSize*(s.page-1):s.page=1,!s.dataEndpoint)throw Error("No dataEndpoint configured. Use configure() before to add it.");const t=new URL(s.dataEndpoint);if(t.searchParams.set("_shape","objects"),t.searchParams.set("_rowid","hide"),t.searchParams.set("_size",s.pageSize.toString()),t.searchParams.set("_offset",n.toString()),s.filters.forEach(({field:r,value:o,comp:l})=>{t.searchParams.set(`${r}__${l}`,o)}),s.sortBy){const r=s.sortDesc?"_sort_desc":"_sort";t.searchParams.set(r,s.sortBy)}return t}function j(e){const n=he(e);return fetch(n.toString()).then(t=>{const r=t.json();return t.ok||Promise.reject(r),r})}function me(e){if(!s.csvapiUrl)throw Error("No csvapiUrl configured. Use configure() before to add it.");const n=new URL(s.csvapiUrl);return n.pathname="/apify",n.searchParams.set("url",encodeURI(e)),n.searchParams.set("analysis","yes"),fetch(n.toString()).then(t=>{const r=t.json();return t.ok||Promise.reject(r),r})}function _e(e,n){const t=document.querySelector(e);return t?t.getAttribute(n):null}function A(e){return _e(`meta[name=${e}]`,"content")}const ve=A("tabular-csvapi-url"),L=A("tabular-page-size"),ye=T({components:{ContentLoader:H},setup(){return{getY(e){return 16+4+e*(16*2+24)}}}}),ze=a("rect",{x:"16",y:"16",rx:"4",ry:"4",width:"112",height:"24"},null,-1),we=a("rect",{x:"160",y:"16",rx:"4",ry:"4",width:"116",height:"24"},null,-1),$e=a("rect",{x:"308",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1),Pe=a("rect",{x:"480",y:"16",rx:"4",ry:"4",width:"106",height:"24"},null,-1),be=a("rect",{x:"618",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1),ke=a("rect",{x:"790",y:"16",rx:"4",ry:"4",width:"144",height:"24"},null,-1),Ce=a("rect",{x:"966",y:"16",rx:"4",ry:"4",width:"142",height:"24"},null,-1),Se=a("rect",{x:"4",y:"56",rx:"4",ry:"4",width:"1116",height:"4"},null,-1),Ee=["y"],Le=["y"],Ue=["y"],Be=["y"],Ne=["y"],De=["y"],Te=["y"];function Re(e,n,t,r,o,l){const i=N("ContentLoader");return u(),D(i,{width:1124,height:300,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:K(()=>[ze,we,$e,Pe,be,ke,Ce,Se,(u(),d(m,null,w(5,f=>(u(),d(m,null,[a("rect",{x:"16",y:e.getY(f),rx:"4",ry:"4",width:"112",height:"32"},null,8,Ee),a("rect",{x:"160",y:e.getY(f),rx:"4",ry:"4",width:"116",height:"32"},null,8,Le),a("rect",{x:"308",y:e.getY(f),rx:"4",ry:"4",width:"140",height:"32"},null,8,Ue),a("rect",{x:"480",y:e.getY(f),rx:"4",ry:"4",width:"106",height:"32"},null,8,Be),a("rect",{x:"618",y:e.getY(f),rx:"4",ry:"4",width:"140",height:"32"},null,8,Ne),a("rect",{x:"790",y:e.getY(f),rx:"4",ry:"4",width:"144",height:"32"},null,8,De),a("rect",{x:"966",y:e.getY(f),rx:"4",ry:"4",width:"142",height:"32"},null,8,Te)],64))),64))]),_:1})}const je=R(ye,[["render",Re]]),Ye=T({components:{Loader:je,Pagination:ce},props:{resource:{type:Object,required:!0}},setup(e){const n=h([]),t=h([]),r=h(0),o=h(null),l=h(!0),i=h(!1),f=h(1),p=h(null),y=Number.parseInt(L!=null?L:"10"),z=h(null),v=h(!1),P=U(()=>({csvapiUrl:ve,dataEndpoint:p.value,filters:[],page:f.value,pageSize:y,sortBy:z.value,sortDesc:v.value,totalRows:r.value})),E=c=>{c.ok?(t.value=c.rows,n.value=c.columns,r.value=c.total,o.value=c.columns.length):i.value=!0},F=c=>{C(P.value);const b=ge(c);b&&b.then(E).catch(()=>i.value=!0).finally(()=>l.value=!1),f.value=c},M=c=>(z.value==c?v.value=!v.value:v.value=!1,z.value=c,C(P.value),pe(z.value,v.value).then(b=>{E(b),f.value=1}).catch(()=>i.value=!0).finally(()=>l.value=!1)),V=()=>(l.value=!0,C(P.value),j("apify").then(c=>{E(c)}).catch(()=>i.value=!0).finally(()=>l.value=!1)),I=()=>(C(P.value),me(e.resource.url).then(c=>{if(c.ok)return p.value=c.endpoint,V();i.value=!0,l.value=!1}).catch(()=>{i.value=!0,l.value=!1})),G=c=>c===z.value;return I(),{hasError:i,loading:l,columns:n,rows:t,rowCount:r,columnCount:o,sortbyfield:M,isSortedBy:G,sortDesc:v,currentPage:f,pageSize:y,changeExplorePage:F}}}),qe={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-my-2w"},Oe={class:"fr-grid-row fr-m-0"},Ae=a("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1),Fe={class:"fr-table fr-table--no-background fr-p-0 fr-pt-0-5v fr-m-0"},Me={class:"fr-mb-3w"},Ve={class:"fr-sr-only"},Ie={scope:"col"},Ge={class:"fr-grid-row fr-grid-row--middle no-wrap"},Ke=["onClick"],He={class:"fr-sr-only"},Je={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle fr-px-5v"},Qe={class:"fr-col"},We={class:"fr-col-auto"},Xe=["href"];function Ze(e,n,t,r,o,l){const i=N("Loader"),f=N("Pagination");return u(),d(m,null,[e.hasError?(u(),d("div",qe,[a("p",Oe,[Ae,Y(" "+g(e.$t("The preview of this file failed to load.")),1)])])):k("",!0),e.loading?(u(),D(i,{key:1})):k("",!0),!e.hasError&&!e.loading?(u(),d(m,{key:2},[a("div",Fe,[a("table",Me,[a("caption",Ve,g(e.$t("Preview of {name}",{name:e.resource.title})),1),a("thead",null,[a("tr",null,[(u(!0),d(m,null,w(e.columns,p=>(u(),d("th",Ie,[a("div",Ge,[a("button",{class:B(["fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-my-n1w",{"fr-btn--secondary-grey-500":!e.isSortedBy(p),"fr-btn--icon-right":e.isSortedBy(p),"fr-icon-arrow-down-line":e.isSortedBy(p)&&e.sortDesc,"fr-icon-arrow-up-line":e.isSortedBy(p)&&!e.sortDesc}]),onClick:y=>e.sortbyfield(p)},[Y(g(p)+" ",1),a("span",He,g(e.sortDesc?e.$t("Sort ascending"):e.$t("Sort descending")),1)],10,Ke)])]))),256))])]),a("tbody",null,[(u(!0),d(m,null,w(e.rows,p=>(u(),d("tr",null,[(u(!0),d(m,null,w(e.columns,y=>(u(),d("td",null,g(p[y]),1))),256))]))),256))])])]),e.rowCount>e.pageSize?(u(),D(f,{key:0,class:"fr-mt-3w",page:e.currentPage,pageSize:e.pageSize,totalResults:e.rowCount,changePage:e.changeExplorePage},null,8,["page","pageSize","totalResults","changePage"])):k("",!0),a("div",Je,[a("div",Qe,g(e.$t("{count} columns",e.columnCount))+" \u2014 "+g(e.$t("{count} rows",e.rowCount)),1),a("div",We,[a("a",{href:e.resource.preview_url,class:"fr-btn fr-btn--icon-left fr-icon-test-tube-line"},g(e.$t("Explore data")),9,Xe)])])],64)):k("",!0)],64)}const xe=R(Ye,[["render",Ze]]),en={en:{"Preview of {name}":e=>{const{normalize:n,interpolate:t,named:r}=e;return n(["Preview of ",t(r("name"))])},"{count} columns":e=>{const{normalize:n,interpolate:t,named:r,plural:o}=e;return o([n([t(r("count"))," columns"]),n([t(r("count"))," column"]),n([t(r("count"))," columns"])])},"Explore data":e=>{const{normalize:n}=e;return n(["Explore data"])},"The preview of this file failed to load.":e=>{const{normalize:n}=e;return n(["The preview of this file failed to load."])},"{count} rows":e=>{const{normalize:n,interpolate:t,named:r,plural:o}=e;return o([n([t(r("count"))," rows"]),n([t(r("count"))," row"]),n([t(r("count"))," rows"])])},"Sort ascending":e=>{const{normalize:n}=e;return n(["Sort ascending"])},"Sort descending":e=>{const{normalize:n}=e;return n(["Sort descending"])}},es:{"Preview of {name}":e=>{const{normalize:n}=e;return n([])},"{count} columns":e=>{const{normalize:n}=e;return n([])},"Explore data":e=>{const{normalize:n}=e;return n([])},"The preview of this file failed to load.":e=>{const{normalize:n}=e;return n([])},"{count} rows":e=>{const{normalize:n}=e;return n([])},"Sort ascending":e=>{const{normalize:n}=e;return n([])},"Sort descending":e=>{const{normalize:n}=e;return n([])}},fr:{"Preview of {name}":e=>{const{normalize:n,interpolate:t,named:r}=e;return n(["Pr\xE9visualisation de ",t(r("name"))])},"{count} columns":e=>{const{normalize:n,interpolate:t,named:r,plural:o}=e;return o([n([t(r("count"))," colonnes"]),n([t(r("count"))," colonne"]),n([t(r("count"))," colonnes"])])},"Explore data":e=>{const{normalize:n}=e;return n(["Explorer les donn\xE9es"])},"The preview of this file failed to load.":e=>{const{normalize:n}=e;return n(["La pr\xE9visualisation de ce fichier n'a pas pu \xEAtre charg\xE9e."])},"{count} rows":e=>{const{normalize:n,interpolate:t,named:r,plural:o}=e;return o([n([t(r("count"))," lignes"]),n([t(r("count"))," ligne"]),n([t(r("count"))," lignes"])])},"Sort ascending":e=>{const{normalize:n}=e;return n(["Trier par ordre croissant"])},"Sort descending":e=>{const{normalize:n}=e;return n(["Trier par ordre d\xE9croissant"])}},it:{"Preview of {name}":e=>{const{normalize:n}=e;return n([])},"{count} columns":e=>{const{normalize:n}=e;return n([])},"Explore data":e=>{const{normalize:n}=e;return n([])},"The preview of this file failed to load.":e=>{const{normalize:n}=e;return n([])},"Sort ascending":e=>{const{normalize:n}=e;return n([])},"Sort descending":e=>{const{normalize:n}=e;return n([])},"Showing the first {shown} of {count} rows":e=>{const{normalize:n}=e;return n([])}},sr:{"Preview of {name}":e=>{const{normalize:n}=e;return n([])},"{count} columns":e=>{const{normalize:n}=e;return n([])},"Explore data":e=>{const{normalize:n}=e;return n([])},"The preview of this file failed to load.":e=>{const{normalize:n}=e;return n([])},"Sort ascending":e=>{const{normalize:n}=e;return n([])},"Sort descending":e=>{const{normalize:n}=e;return n([])},"Showing the first {shown} of {count} rows":e=>{const{normalize:n}=e;return n([])}}};de("explore",xe,"udata-tabular-preview","explore");fe(en,"udata-tabular-preview");export{nn as __vite_legacy_guard};
